import{v as e,_ as t}from"./server.mjs";import{ref as r,computed as a,unref as s,defineComponent as o,watch as i,nextTick as l,useSSRContext as d}from"vue";import{ssrRenderAttrs as n,ssrRenderComponent as c,ssrRenderAttr as u,ssrIncludeBooleanAttr as m,ssrLooseContain as p,ssrLooseEqual as v,ssrRenderList as x,ssrInterpolate as g,ssrRenderClass as b,ssrRenderTeleport as f}from"vue/server-renderer";import"../_/nitro.mjs";import"@supabase/supabase-js";import"node:http";import"node:https";import"node:events";import"node:buffer";import"@supabase/ssr";import"@iconify/utils";import"node:crypto";import"consola";import"ioredis";import"node:fs";import"node:path";import"pinia";import"vue-router";import"tailwindcss/colors";import"@iconify/vue";import"reka-ui";import"@vueuse/core";import"tailwind-variants";import"@iconify/utils/lib/css/icon";import"../routes/renderer.mjs";import"vue-bundle-renderer/runtime";import"unhead/server";import"unhead/utils";import"unhead/plugins";const y=o({__name:"CategoryAddModal",__ssrInlineRender:!0,props:{category:{type:Object,default:null}},emits:["close","save"],setup(e,{emit:o}){const l=e,d=r(!1),n=r({name:"",description:"",is_active:!0}),v=r(null),x=r(""),b=a(()=>!!l.category);return i(()=>l.category,()=>{l.category?(n.value={name:l.category.name,description:l.category.description||"",is_active:l.category.is_active},x.value=l.category.image_url||""):(n.value={name:"",description:"",is_active:!0},x.value="",v.value=null)},{immediate:!0}),(e,r,a,o)=>{const i=t;f(r,e=>{e('<div class="fixed inset-0 z-[9998] overflow-y-auto" role="dialog" aria-modal="true"><div class="flex items-center justify-center min-h-screen p-4"><div class="fixed inset-0 bg-black/50"></div><div class="relative z-[9999] w-full max-w-xl bg-white rounded-lg text-left overflow-hidden shadow-xl"><div class="bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4"><div class="sm:flex sm:items-start"><div class="mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-blue-100 sm:mx-0 sm:h-10 sm:w-10">'),e(c(i,{name:s(b)?"heroicons:pencil-square":"heroicons:plus",class:"h-6 w-6 text-blue-600"},null,a)),e(`</div><div class="mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left w-full"><h3 class="text-lg leading-6 font-medium text-gray-900">${g(s(b)?"Editar Categoría":"Crear Nueva Categoría")}</h3><form class="mt-4 space-y-4"><div class="grid grid-cols-1 gap-4"><div><label class="block text-sm font-medium text-gray-700 mb-1">Nombre *</label><input${u("value",s(n).name)} type="text" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Nombre de la categoría"></div><div><label class="block text-sm font-medium text-gray-700 mb-1">Descripción</label><textarea rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Descripción (opcional)">${g(s(n).description)}</textarea></div><div><label class="block text-sm font-medium text-gray-700 mb-1">Imagen (opcional)</label><input type="file" accept="image/*" class="w-full"></div><div class="flex items-center"><input${m(Array.isArray(s(n).is_active)?p(s(n).is_active,null):s(n).is_active)?" checked":""} type="checkbox" id="is_active" class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"><label for="is_active" class="ml-2 block text-sm text-gray-900">Categoría activa</label></div></div>`),s(x)?e(`<div class="col-span-2"><label class="block text-sm font-medium text-gray-700 mb-1">Vista previa</label><div class="w-32 h-32 border border-gray-300 rounded-lg overflow-hidden"><img${u("src",s(x))}${u("alt",s(n).name)} class="w-full h-full object-cover"></div></div>`):e("\x3c!----\x3e"),e(`</form></div></div></div><div class="bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse"><button type="submit"${m(s(d))?" disabled":""} class="w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-600 text-base font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm disabled:opacity-50 disabled:cursor-not-allowed">`),s(d)?e(c(i,{name:"heroicons:arrow-path",class:"w-4 h-4 mr-2 animate-spin"},null,a)):e("\x3c!----\x3e"),e(` ${g(s(b)?"Actualizar":"Crear")}</button><button type="button" class="mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm"> Cancelar </button></div></div></div></div>`)},"body",!1,a)}}}),h=y.setup;y.setup=(e,t)=>{const r=d();return(r.modules||(r.modules=new Set)).add("components/admin/categories/CategoryAddModal.vue"),h?h(e,t):void 0};const w={__name:"CategoryDeleteModal",__ssrInlineRender:!0,props:{category:{type:Object,required:!0}},emits:["confirm","cancel"],setup:e=>(r,a,s,o)=>{const i=t;f(a,t=>{var r;t('<div class="fixed inset-0 z-[9998] overflow-y-auto" role="dialog" aria-modal="true"><div class="flex items-center justify-center min-h-screen p-4"><div class="fixed inset-0 bg-black/50"></div><div class="relative z-[9999] w-full max-w-lg bg-white rounded-lg text-left overflow-hidden shadow-xl"><div class="bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4"><div class="sm:flex sm:items-start"><div class="mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-red-100 sm:mx-0 sm:h-10 sm:w-10">'),t(c(i,{name:"heroicons:exclamation-triangle",class:"h-6 w-6 text-red-600"},null,s)),t(`</div><div class="mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left"><h3 class="text-lg leading-6 font-medium text-gray-900">Eliminar Categoría</h3><div class="mt-2"><p class="text-sm text-gray-500">¿Estás seguro de eliminar &#39;${g(null==(r=e.category)?void 0:r.name)}&#39;? Esta acción no se puede deshacer.</p></div></div></div></div><div class="bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse"><button type="button" class="w-full btn btn-danger sm:ml-3 sm:w-auto sm:text-sm"> Confirmar </button><button type="button" class="mt-3 w-full btn btn-secondary sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm"> Cancelar </button></div></div></div></div>`)},"body",!1,s)}},$=w.setup;w.setup=(e,t)=>{const r=d();return(r.modules||(r.modules=new Set)).add("components/admin/categories/CategoryDeleteModal.vue"),$?$(e,t):void 0};const _={__name:"index",__ssrInlineRender:!0,setup(o){const i=r([]),d=r(!1),f=r(""),h=r(""),$=r(1),_=r(10),C=r(!1),E=r(!1),k=r(null),A=r(null),j=a(()=>{let e=i.value;if(f.value){const t=f.value.toLowerCase();e=e.filter(e=>e.name.toLowerCase().includes(t)||e.description&&e.description.toLowerCase().includes(t))}if(""!==h.value){const t="true"===h.value;e=e.filter(e=>e.is_active===t)}return e}),M=a(()=>j.value.length),z=a(()=>Math.ceil(M.value/_.value)),D=a(()=>($.value-1)*_.value),S=a(()=>Math.min(D.value+_.value,M.value)),L=a(()=>{const e=[];let t=Math.max(1,$.value-Math.floor(2.5)),r=Math.min(z.value,t+5-1);r-t+1<5&&(t=Math.max(1,r-5+1));for(let a=t;a<=r;a++)e.push(a);return e}),I=async()=>{d.value=!0;try{const{data:e}=await $fetch("/api/categories");e.success?i.value=e.data:console.error("Error en la respuesta de la API:",e.error)}catch(e){console.error("Error fetching categories:",e)}finally{d.value=!1}},T=e(),N=()=>{C.value=!1,k.value=null},q=async e=>{try{if(k.value){const t=`/api/categories/${k.value.id_category}`,{data:r}=await $fetch(t,{method:"PUT",body:e});if(!r.success)return console.error("Error actualizando categoría:",r.error),void T.add({title:r.error||"Error actualizando categoría",color:"red"});T.add({title:"Categoría actualizada",color:"green"})}else{const{data:t}=await $fetch("/api/categories",{method:"POST",body:e});if(!t.success)return console.error("Error creando categoría:",t.error),void T.add({title:t.error||"Error creando categoría",color:"red"});T.add({title:"Categoría creada",color:"green"})}await I(),N()}catch(e){console.error("Error saving category:",e),T.add({title:"Error guardando categoría",color:"red"})}},P=async()=>{try{const{data:e}=await $fetch(`/api/categories/${A.value.id_category}`,{method:"DELETE"});e.success?(T.add({title:"Categoría eliminada",color:"green"}),await I(),l(()=>{E.value=!1,A.value=null})):(console.error("Error eliminando categoría:",e.error),T.add({title:e.error||"Error eliminando categoría",color:"red"}))}catch(e){console.error("Error deleting category:",e),T.add({title:"Error eliminando categoría",color:"red"})}};return(e,r,a,o)=>{const i=t,l=y,d=w;r(`<div${n(o)}><div class="flex justify-between items-center mb-6"><div><h1 class="text-2xl font-bold text-gray-900">Gestión de Categorías</h1><p class="text-gray-600">Administra las categorías de productos de tu tienda</p></div><button class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center space-x-2 transition-colors">`),r(c(i,{name:"heroicons:plus",class:"w-5 h-5"},null,a)),r(`<span>Agregar Categoría</span></button></div><div class="bg-white p-4 rounded-lg shadow-sm mb-6"><div class="grid grid-cols-1 md:grid-cols-3 gap-4"><div><label class="block text-sm font-medium text-gray-700 mb-1">Buscar</label><input${u("value",s(f))} type="text" placeholder="Nombre o descripción..." class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"></div><div><label class="block text-sm font-medium text-gray-700 mb-1">Estado</label><select class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"><option value=""${m(Array.isArray(s(h))?p(s(h),""):v(s(h),""))?" selected":""}>Todos los estados</option><option value="true"${m(Array.isArray(s(h))?p(s(h),"true"):v(s(h),"true"))?" selected":""}>Activa</option><option value="false"${m(Array.isArray(s(h))?p(s(h),"false"):v(s(h),"false"))?" selected":""}>Inactiva</option></select></div><div class="flex items-end"><button class="w-full px-4 py-2 text-gray-600 border border-gray-300 rounded-md hover:bg-gray-50 transition-colors"> Limpiar Filtros </button></div></div></div><div class="bg-white rounded-lg shadow-sm overflow-hidden"><div class="overflow-x-auto"><table class="min-w-full divide-y divide-gray-200"><thead class="bg-gray-50"><tr><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"> Categoría </th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"> Descripción </th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"> Productos </th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"> Estado </th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"> Fecha Creación </th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"> Acciones </th></tr></thead><tbody class="bg-white divide-y divide-gray-200">\x3c!--[--\x3e`),x(s(j).slice(s(D),s(S)),e=>{var t;r('<tr class="hover:bg-gray-50"><td class="px-6 py-4 whitespace-nowrap"><div class="flex items-center"><div class="flex-shrink-0 h-10 w-10"><div class="h-10 w-10 rounded-lg bg-blue-100 flex items-center justify-center">'),r(c(i,{name:"heroicons:tag",class:"w-5 h-5 text-blue-600"},null,a)),r(`</div></div><div class="ml-4"><div class="text-sm font-medium text-gray-900">${g(e.name)}</div></div></div></td><td class="px-6 py-4"><div class="text-sm text-gray-900 max-w-xs truncate">${g(e.description||"Sin descripción")}</div></td><td class="px-6 py-4 whitespace-nowrap"><span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800">${g(e.product_count||0)} productos </span></td><td class="px-6 py-4 whitespace-nowrap"><span class="${b(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",e.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"])}">${g(e.is_active?"Activa":"Inactiva")}</span></td><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${g((t=e.created_at,t?new Date(t).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric"}):"N/A"))}</td><td class="px-6 py-4 whitespace-nowrap text-sm font-medium"><div class="flex space-x-2"><button class="text-indigo-600 hover:text-indigo-900" title="Editar categoría">`),r(c(i,{name:"heroicons:pencil-square",class:"w-5 h-5"},null,a)),r(`</button><button class="${b(["hover:text-gray-900",e.is_active?"text-red-600":"text-green-600"])}"${u("title",e.is_active?"Desactivar categoría":"Activar categoría")}>`),r(c(i,{name:e.is_active?"heroicons:eye-slash":"heroicons:eye",class:"w-5 h-5"},null,a)),r('</button><button class="text-red-600 hover:text-red-900" title="Eliminar categoría">'),r(c(i,{name:"heroicons:trash",class:"w-5 h-5"},null,a)),r("</button></div></td></tr>")}),r("\x3c!--]--\x3e</tbody></table></div>"),s(z)>1?(r(`<div class="bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6"><div class="flex-1 flex justify-between sm:hidden"><button${m(1===s($))?" disabled":""} class="relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"> Anterior </button><button${m(s($)===s(z))?" disabled":""} class="ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"> Siguiente </button></div><div class="hidden sm:flex-1 sm:flex sm:items-center sm:justify-between"><div><p class="text-sm text-gray-700"> Mostrando <span class="font-medium">${g(s(D)+1)}</span> a <span class="font-medium">${g(s(S))}</span> de <span class="font-medium">${g(s(M))}</span> resultados </p></div><div><nav class="relative z-0 inline-flex rounded-md shadow-sm -space-x-px"><button${m(1===s($))?" disabled":""} class="relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed">`),r(c(i,{name:"heroicons:chevron-left",class:"w-5 h-5"},null,a)),r("</button>\x3c!--[--\x3e"),x(s(L),e=>{r(`<button class="${b(["relative inline-flex items-center px-4 py-2 border text-sm font-medium",e===s($)?"z-10 bg-blue-50 border-blue-500 text-blue-600":"bg-white border-gray-300 text-gray-500 hover:bg-gray-50"])}">${g(e)}</button>`)}),r(`\x3c!--]--\x3e<button${m(s($)===s(z))?" disabled":""} class="relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed">`),r(c(i,{name:"heroicons:chevron-right",class:"w-5 h-5"},null,a)),r("</button></nav></div></div></div>")):r("\x3c!----\x3e"),r("</div>"),s(C)?r(c(l,{category:s(k),onClose:N,onSave:q},null,a)):r("\x3c!----\x3e"),s(E)?r(c(d,{category:s(A),onConfirm:P,onCancel:e=>E.value=!1},null,a)):r("\x3c!----\x3e"),r("</div>")}}},C=_.setup;_.setup=(e,t)=>{const r=d();return(r.modules||(r.modules=new Set)).add("pages/admin/categories/index.vue"),C?C(e,t):void 0};export{_ as default};
//# sourceMappingURL=index-BzVmJo5w.mjs.map
