import{v as e,_ as t}from"./server.mjs";import{ref as r,computed as s,unref as o,watch as a,useSSRContext as i}from"vue";import{ssrRenderAttrs as l,ssrRenderComponent as d,ssrRenderAttr as n,ssrIncludeBooleanAttr as c,ssrLooseContain as u,ssrLooseEqual as m,ssrRenderList as p,ssrInterpolate as v,ssrRenderClass as x,ssrRenderTeleport as b}from"vue/server-renderer";import"../_/nitro.mjs";import"@supabase/supabase-js";import"node:http";import"node:https";import"node:events";import"node:buffer";import"@supabase/ssr";import"@iconify/utils";import"node:crypto";import"consola";import"ioredis";import"node:fs";import"node:path";import"pinia";import"vue-router";import"tailwindcss/colors";import"@iconify/vue";import"reka-ui";import"@vueuse/core";import"tailwind-variants";import"@iconify/utils/lib/css/icon";import"../routes/renderer.mjs";import"vue-bundle-renderer/runtime";import"unhead/server";import"unhead/utils";import"unhead/plugins";const g={__name:"ProviderModal",__ssrInlineRender:!0,props:{provider:{type:Object,default:null}},emits:["close","save"],setup(e,{emit:s}){const i=e,l=r(!1),m=r({name:"",email:"",phone:"",contact_person:"",address:"",city:"",is_active:!0});return a(()=>i.provider,e=>{m.value=e?{name:e.name||"",email:e.email||"",phone:e.phone||"",contact_person:e.contact_person||"",address:e.address||"",city:e.city||"",is_active:void 0===e.is_active||e.is_active}:{name:"",email:"",phone:"",contact_person:"",address:"",city:"",is_active:!0}},{immediate:!0}),(r,s,a,i)=>{const p=t;b(s,t=>{t('<div class="fixed inset-0 z-[9998] overflow-y-auto" role="dialog" aria-modal="true"><div class="flex items-center justify-center min-h-screen p-4"><div class="fixed inset-0 bg-black/50"></div><div class="relative z-[9999] w-full max-w-2xl bg-white rounded-lg text-left overflow-hidden shadow-xl"><div class="bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4"><div class="sm:flex sm:items-start"><div class="mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-green-100 sm:mx-0 sm:h-10 sm:w-10">'),t(d(p,{name:"heroicons:building-storefront",class:"h-6 w-6 text-green-600"},null,a)),t(`</div><div class="mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left w-full"><h3 class="text-lg leading-6 font-medium text-gray-900">${v(e.provider?"Editar Proveedor":"Nuevo Proveedor")}</h3><form class="mt-4 space-y-4"><div><label class="block text-sm font-medium text-gray-700 mb-1"> Nombre * </label><input${n("value",o(m).name)} type="text" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500" placeholder="Nombre del proveedor"></div><div><label class="block text-sm font-medium text-gray-700 mb-1"> Email </label><input${n("value",o(m).email)} type="email" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500" placeholder="email@proveedor.com"></div><div><label class="block text-sm font-medium text-gray-700 mb-1"> Teléfono </label><input${n("value",o(m).phone)} type="tel" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500" placeholder="+52 123 456 7890"></div><div><label class="block text-sm font-medium text-gray-700 mb-1"> Persona de Contacto </label><input${n("value",o(m).contact_person)} type="text" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500" placeholder="Nombre del contacto"></div><div><label class="block text-sm font-medium text-gray-700 mb-1"> Dirección </label><textarea rows="2" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500" placeholder="Dirección completa">${v(o(m).address)}</textarea></div><div><label class="block text-sm font-medium text-gray-700 mb-1"> Ciudad </label><input${n("value",o(m).city)} type="text" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500" placeholder="Ciudad"></div><div class="flex items-center"><input${c(Array.isArray(o(m).is_active)?u(o(m).is_active,null):o(m).is_active)?" checked":""} type="checkbox" id="is_active" class="h-4 w-4 text-green-600 focus:ring-green-500 border-gray-300 rounded"><label for="is_active" class="ml-2 block text-sm text-gray-900"> Proveedor activo </label></div></form></div></div></div><div class="bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse"><button type="submit"${c(o(l))?" disabled":""} class="w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-green-600 text-base font-medium text-white hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 sm:ml-3 sm:w-auto sm:text-sm disabled:opacity-50 disabled:cursor-not-allowed">`),o(l)?t(d(p,{name:"heroicons:arrow-path",class:"w-4 h-4 mr-2 animate-spin"},null,a)):t("\x3c!----\x3e"),t(` ${v(e.provider?"Actualizar":"Crear")}</button><button type="button" class="mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm"> Cancelar </button></div></div></div></div>`)},"body",!1,a)}}},f=g.setup;g.setup=(e,t)=>{const r=i();return(r.modules||(r.modules=new Set)).add("components/admin/providers/ProviderModal.vue"),f?f(e,t):void 0};const y={__name:"ProviderDeleteModal",__ssrInlineRender:!0,props:{provider:{type:Object,required:!0}},emits:["confirm","cancel"],setup:e=>(r,s,o,a)=>{const i=t;b(s,t=>{var r;t('<div class="fixed inset-0 z-[9998] overflow-y-auto" role="dialog" aria-modal="true"><div class="flex items-center justify-center min-h-screen p-4"><div class="fixed inset-0 bg-black/50"></div><div class="relative z-[9999] w-full max-w-lg bg-white rounded-lg text-left overflow-hidden shadow-xl"><div class="bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4"><div class="sm:flex sm:items-start"><div class="mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-red-100 sm:mx-0 sm:h-10 sm:w-10">'),t(d(i,{name:"heroicons:exclamation-triangle",class:"h-6 w-6 text-red-600"},null,o)),t(`</div><div class="mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left"><h3 class="text-lg leading-6 font-medium text-gray-900">Eliminar Proveedor</h3><div class="mt-2"><p class="text-sm text-gray-500"> ¿Estás seguro de que quieres eliminar el proveedor &#39;${v(null==(r=e.provider)?void 0:r.name)}&#39;? Esta acción no se puede deshacer. </p></div></div></div></div><div class="bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse"><button type="button" class="w-full btn btn-danger sm:ml-3 sm:w-auto sm:text-sm"> Confirmar </button><button type="button" class="mt-3 w-full btn btn-secondary sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm"> Cancelar </button></div></div></div></div>`)},"body",!1,o)}},h=y.setup;y.setup=(e,t)=>{const r=i();return(r.modules||(r.modules=new Set)).add("components/admin/providers/ProviderDeleteModal.vue"),h?h(e,t):void 0};const w={__name:"index",__ssrInlineRender:!0,setup(a){const i=r([]),b=r(!1),f=r(""),h=r(""),w=r(1),$=r(10),_=r(!1),k=r(!1),E=r(null),A=r(null),P=s(()=>{let e=i.value;if(f.value){const t=f.value.toLowerCase();e=e.filter(e=>e.name.toLowerCase().includes(t)||e.email&&e.email.toLowerCase().includes(t)||e.contact_person&&e.contact_person.toLowerCase().includes(t))}return""!==h.value&&(e=e.filter(e=>e.is_active.toString()===h.value)),e}),j=s(()=>P.value.length),C=s(()=>Math.ceil(j.value/$.value)),M=s(()=>(w.value-1)*$.value),D=s(()=>Math.min(M.value+$.value,j.value)),I=s(()=>{const e=[];let t=Math.max(1,w.value-Math.floor(2.5)),r=Math.min(C.value,t+5-1);r-t+1<5&&(t=Math.max(1,r-5+1));for(let s=t;s<=r;s++)e.push(s);return e}),z=async()=>{b.value=!0;try{const{data:e}=await $fetch("/api/providers");e.success?i.value=e.data:console.error("Error en la respuesta de la API:",e.error)}catch(e){console.error("Error fetching providers:",e)}finally{b.value=!1}},N=()=>{_.value=!1,E.value=null},S=async e=>{try{if(E.value){const{data:t}=await $fetch(`/api/providers/${E.value.id_provider}`,{method:"PUT",body:e});t.success?(T.add({title:"Proveedor actualizado",color:"green"}),await z(),N()):(console.error("Error actualizando proveedor:",t.error),T.add({title:t.error||"Error actualizando proveedor",color:"red"}))}else{const{data:t}=await $fetch("/api/providers",{method:"POST",body:e});t.success?(T.add({title:"Proveedor creado",color:"green"}),await z(),N()):(console.error("Error creando proveedor:",t.error),T.add({title:t.error||"Error creando proveedor",color:"red"}))}}catch(e){console.error("Error saving provider:",e);const t=e,r=t&&t.data&&t.data.error||t&&t.message||"Error guardando proveedor";T.add({title:r,color:"red"})}},T=e(),L=async()=>{if(A.value)try{const{data:e}=await $fetch(`/api/providers/${A.value.id_provider}`,{method:"DELETE"});e.success?(T.add({title:"Proveedor eliminado",color:"green"}),await z(),k.value=!1,A.value=null):(console.error("Error eliminando proveedor:",e.error),T.add({title:e.error||"Error eliminando proveedor",color:"red"}))}catch(e){console.error("Error deleting provider:",e);const t=e,r=t&&t.data&&t.data.error||t&&t.message||"Error eliminando proveedor";T.add({title:r,color:"red"})}};return(e,r,s,a)=>{const i=t,b=g,$=y;r(`<div${l(a)}><div class="flex justify-between items-center mb-6"><div><h1 class="text-2xl font-bold text-gray-900">Gestión de Proveedores</h1><p class="text-gray-600">Administra los proveedores de tu tienda</p></div><button class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg flex items-center space-x-2 transition-colors">`),r(d(i,{name:"heroicons:plus-circle",class:"w-5 h-5"},null,s)),r(`<span>Nuevo Proveedor</span></button></div><div class="bg-white p-4 rounded-lg shadow-sm mb-6"><div class="grid grid-cols-1 md:grid-cols-3 gap-4"><div><label class="block text-sm font-medium text-gray-700 mb-1">Buscar</label><input${n("value",o(f))} type="text" placeholder="Nombre, email, contacto..." class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500"></div><div><label class="block text-sm font-medium text-gray-700 mb-1">Estado</label><select class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500"><option value=""${c(Array.isArray(o(h))?u(o(h),""):m(o(h),""))?" selected":""}>Todos los estados</option><option value="true"${c(Array.isArray(o(h))?u(o(h),"true"):m(o(h),"true"))?" selected":""}>Activo</option><option value="false"${c(Array.isArray(o(h))?u(o(h),"false"):m(o(h),"false"))?" selected":""}>Inactivo</option></select></div><div class="flex items-end"><button class="w-full px-4 py-2 text-gray-600 border border-gray-300 rounded-md hover:bg-gray-50 transition-colors"> Limpiar Filtros </button></div></div></div><div class="bg-white rounded-lg shadow-sm overflow-hidden"><div class="overflow-x-auto"><table class="min-w-full divide-y divide-gray-200"><thead class="bg-gray-50"><tr><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"> Proveedor </th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"> Contacto </th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"> Dirección </th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"> Estado </th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"> Productos </th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"> Acciones </th></tr></thead><tbody class="bg-white divide-y divide-gray-200">\x3c!--[--\x3e`),p(o(P).slice(o(M),o(D)),e=>{r('<tr class="hover:bg-gray-50"><td class="px-6 py-4 whitespace-nowrap"><div class="flex items-center"><div class="flex-shrink-0 h-10 w-10"><div class="h-10 w-10 rounded-full bg-green-100 flex items-center justify-center">'),r(d(i,{name:"heroicons:truck",class:"w-5 h-5 text-green-600"},null,s)),r(`</div></div><div class="ml-4"><div class="text-sm font-medium text-gray-900">${v(e.name)}</div><div class="text-sm text-gray-500">${v(e.email)}</div></div></div></td><td class="px-6 py-4 whitespace-nowrap"><div class="text-sm text-gray-900">${v(e.contact_person||"N/A")}</div><div class="text-sm text-gray-500">${v(e.phone||"N/A")}</div></td><td class="px-6 py-4 whitespace-nowrap"><div class="text-sm text-gray-900">${v(e.address||"N/A")}</div><div class="text-sm text-gray-500">${v(e.city||"N/A")}</div></td><td class="px-6 py-4 whitespace-nowrap"><span class="${x(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",e.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"])}">${v(e.is_active?"Activo":"Inactivo")}</span></td><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${v(e.product_count||0)} productos </td><td class="px-6 py-4 whitespace-nowrap text-sm font-medium"><div class="flex space-x-2"><button class="text-blue-600 hover:text-blue-900" title="Editar proveedor">`),r(d(i,{name:"heroicons:pencil",class:"w-5 h-5"},null,s)),r(`</button><button class="${x(["hover:text-gray-900",e.is_active?"text-orange-600":"text-green-600"])}"${n("title",e.is_active?"Desactivar":"Activar")}>`),r(d(i,{name:e.is_active?"heroicons:pause":"heroicons:play",class:"w-5 h-5"},null,s)),r('</button><button class="text-red-600 hover:text-red-900" title="Eliminar proveedor">'),r(d(i,{name:"heroicons:trash",class:"w-5 h-5"},null,s)),r("</button></div></td></tr>")}),r("\x3c!--]--\x3e</tbody></table></div>"),o(C)>1?(r(`<div class="bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6"><div class="flex-1 flex justify-between sm:hidden"><button${c(1===o(w))?" disabled":""} class="relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"> Anterior </button><button${c(o(w)===o(C))?" disabled":""} class="ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"> Siguiente </button></div><div class="hidden sm:flex-1 sm:flex sm:items-center sm:justify-between"><div><p class="text-sm text-gray-700"> Mostrando <span class="font-medium">${v(o(M)+1)}</span> a <span class="font-medium">${v(o(D))}</span> de <span class="font-medium">${v(o(j))}</span> resultados </p></div><div><nav class="relative z-0 inline-flex rounded-md shadow-sm -space-x-px"><button${c(1===o(w))?" disabled":""} class="relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed">`),r(d(i,{name:"heroicons:chevron-left",class:"w-5 h-5"},null,s)),r("</button>\x3c!--[--\x3e"),p(o(I),e=>{r(`<button class="${x(["relative inline-flex items-center px-4 py-2 border text-sm font-medium",e===o(w)?"z-10 bg-green-50 border-green-500 text-green-600":"bg-white border-gray-300 text-gray-500 hover:bg-gray-50"])}">${v(e)}</button>`)}),r(`\x3c!--]--\x3e<button${c(o(w)===o(C))?" disabled":""} class="relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed">`),r(d(i,{name:"heroicons:chevron-right",class:"w-5 h-5"},null,s)),r("</button></nav></div></div></div>")):r("\x3c!----\x3e"),r("</div>"),o(_)?r(d(b,{provider:o(E),onClose:N,onSave:S},null,s)):r("\x3c!----\x3e"),o(k)&&o(A)?r(d($,{provider:o(A),onConfirm:L,onCancel:e=>k.value=!1},null,s)):r("\x3c!----\x3e"),r("</div>")}}},$=w.setup;w.setup=(e,t)=>{const r=i();return(r.modules||(r.modules=new Set)).add("pages/admin/providers/index.vue"),$?$(e,t):void 0};export{w as default};
//# sourceMappingURL=index-Cp9HbBdp.mjs.map
