import{b as e,_ as t,a}from"./server.mjs";import{ref as s,mergeProps as d,unref as r,withCtx as i,createTextVNode as c,toDisplayString as l,defineComponent as o,reactive as n,computed as b,useSSRContext as p}from"vue";import{ssrRenderAttrs as v,ssrRenderComponent as u,ssrInterpolate as m,ssrIncludeBooleanAttr as x,ssrLooseContain as g,ssrRenderList as f,ssrRenderAttr as y,ssrRenderClass as h}from"vue/server-renderer";import{i as w}from"./cart-DeOYbeKc.mjs";import{t as k}from"./useCurrency-BC2d31xw.mjs";import{o as $}from"./_plugin-vue_export-helper-BCo6x5W8.mjs";import"../_/nitro.mjs";import"@supabase/supabase-js";import"node:http";import"node:https";import"node:events";import"node:buffer";import"@supabase/ssr";import"@iconify/utils";import"node:crypto";import"consola";import"ioredis";import"node:fs";import"node:path";import"pinia";import"vue-router";import"tailwindcss/colors";import"@iconify/vue";import"reka-ui";import"@vueuse/core";import"tailwind-variants";import"@iconify/utils/lib/css/icon";import"../routes/renderer.mjs";import"vue-bundle-renderer/runtime";import"unhead/server";import"unhead/utils";import"unhead/plugins";const _=o({__name:"MercadoPagoModal",__ssrInlineRender:!0,props:{orderId:{}},emits:["close","success"],setup(a,{emit:i}){const c=w(),{formatCOP:l}=k(),{$toast:o}=e(),p=s(!1),h=s(!1),$=n({name:"",phone:"",address:"",city:"",state:"",postal_code:""}),_=b(()=>h.value&&$.name.trim()&&$.phone.trim()&&$.address.trim()&&$.city.trim()&&$.state.trim()&&$.postal_code.trim());return(e,a,s,i)=>{const o=t;a(`<div${v(d({class:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50"},i))} data-v-3b2cc5eb><div class="bg-white rounded-xl w-full max-w-2xl max-h-[90vh] overflow-y-auto" data-v-3b2cc5eb><div class="sticky top-0 bg-white border-b border-gray-200 p-6 rounded-t-xl" data-v-3b2cc5eb><div class="flex items-center justify-between" data-v-3b2cc5eb><h2 class="text-2xl font-bold text-gray-900" data-v-3b2cc5eb>Finalizar Compra</h2><button class="p-2 rounded-lg hover:bg-gray-100 transition-colors" data-v-3b2cc5eb>`),a(u(o,{name:"heroicons:x-mark",class:"w-6 h-6 text-gray-500"},null,s)),a('</button></div></div><div class="p-6 space-y-6" data-v-3b2cc5eb><div class="bg-gray-50 rounded-lg p-4" data-v-3b2cc5eb><h3 class="text-lg font-semibold text-gray-900 mb-3" data-v-3b2cc5eb>Resumen del Pedido</h3><div class="space-y-2" data-v-3b2cc5eb>\x3c!--[--\x3e'),f(r(c).items,e=>{a('<div class="flex items-center justify-between" data-v-3b2cc5eb><div class="flex items-center gap-3" data-v-3b2cc5eb><div class="w-12 h-12 bg-white rounded-lg flex items-center justify-center overflow-hidden" data-v-3b2cc5eb>'),e.image_url?a(`<img${y("src",e.image_url)}${y("alt",e.name)} class="w-full h-full object-cover" data-v-3b2cc5eb>`):a(u(o,{name:"heroicons:shopping-bag",class:"w-6 h-6 text-pink-500"},null,s)),a(`</div><div data-v-3b2cc5eb><div class="font-medium text-gray-900" data-v-3b2cc5eb>${m(e.name)}</div><div class="text-sm text-gray-500" data-v-3b2cc5eb>Cantidad: ${m(e.quantity)}</div></div></div><div class="text-right" data-v-3b2cc5eb><div class="font-semibold text-gray-900" data-v-3b2cc5eb>${m(r(l)(e.price*e.quantity))}</div></div></div>`)}),a(`\x3c!--]--\x3e</div><div class="border-t border-gray-200 mt-4 pt-4 space-y-2" data-v-3b2cc5eb><div class="flex justify-between text-sm" data-v-3b2cc5eb><span class="text-gray-600" data-v-3b2cc5eb>Subtotal</span><span class="font-medium" data-v-3b2cc5eb>${m(r(l)(r(c).subtotal))}</span></div><div class="flex justify-between text-sm" data-v-3b2cc5eb><span class="text-gray-600" data-v-3b2cc5eb>Envío</span><span class="font-medium" data-v-3b2cc5eb>${m(r(l)(r(c).shippingAmount))}</span></div><div class="flex justify-between text-sm" data-v-3b2cc5eb><span class="text-gray-600" data-v-3b2cc5eb>Impuestos</span><span class="font-medium" data-v-3b2cc5eb>${m(r(l)(r(c).taxAmount))}</span></div><div class="flex justify-between text-lg font-bold border-t border-gray-200 pt-2" data-v-3b2cc5eb><span class="text-gray-900" data-v-3b2cc5eb>Total</span><span class="text-pink-600" data-v-3b2cc5eb>${m(r(l)(r(c).total))}</span></div></div></div><div class="space-y-4" data-v-3b2cc5eb><h3 class="text-lg font-semibold text-gray-900" data-v-3b2cc5eb>Información de Envío</h3><div class="grid grid-cols-1 md:grid-cols-2 gap-4" data-v-3b2cc5eb><div data-v-3b2cc5eb><label class="block text-sm font-medium text-gray-700 mb-1" data-v-3b2cc5eb>Nombre Completo</label><input${y("value",r($).name)} type="text" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent" placeholder="Tu nombre completo" data-v-3b2cc5eb></div><div data-v-3b2cc5eb><label class="block text-sm font-medium text-gray-700 mb-1" data-v-3b2cc5eb>Teléfono</label><input${y("value",r($).phone)} type="tel" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent" placeholder="+57 300 123 4567" data-v-3b2cc5eb></div></div><div data-v-3b2cc5eb><label class="block text-sm font-medium text-gray-700 mb-1" data-v-3b2cc5eb>Dirección</label><input${y("value",r($).address)} type="text" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent" placeholder="Calle 123 #45-67" data-v-3b2cc5eb></div><div class="grid grid-cols-1 md:grid-cols-3 gap-4" data-v-3b2cc5eb><div data-v-3b2cc5eb><label class="block text-sm font-medium text-gray-700 mb-1" data-v-3b2cc5eb>Ciudad</label><input${y("value",r($).city)} type="text" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent" placeholder="Bogotá" data-v-3b2cc5eb></div><div data-v-3b2cc5eb><label class="block text-sm font-medium text-gray-700 mb-1" data-v-3b2cc5eb>Departamento</label><input${y("value",r($).state)} type="text" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent" placeholder="Cundinamarca" data-v-3b2cc5eb></div><div data-v-3b2cc5eb><label class="block text-sm font-medium text-gray-700 mb-1" data-v-3b2cc5eb>Código Postal</label><input${y("value",r($).postal_code)} type="text" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent" placeholder="110111" data-v-3b2cc5eb></div></div></div><div class="space-y-4" data-v-3b2cc5eb><h3 class="text-lg font-semibold text-gray-900" data-v-3b2cc5eb>Método de Pago</h3><div class="border border-gray-200 rounded-lg p-4" data-v-3b2cc5eb><div class="flex items-center gap-3 mb-3" data-v-3b2cc5eb><img src="https://http2.mlstatic.com/storage/logos-api-admin/a5f047d0-9be0-11ec-aad4-c3381f368aaf-m.svg" alt="MercadoPago" class="w-8 h-8" data-v-3b2cc5eb><div data-v-3b2cc5eb><div class="font-medium text-gray-900" data-v-3b2cc5eb>Pago Seguro con MercadoPago</div><div class="text-sm text-gray-500" data-v-3b2cc5eb>Tarjetas, PSE, Nequi, Daviplata y más</div></div></div><div class="flex items-center gap-2 text-sm text-gray-600" data-v-3b2cc5eb>`),a(u(o,{name:"heroicons:shield-check",class:"w-4 h-4 text-green-500"},null,s)),a(`<span data-v-3b2cc5eb>Transacción 100% segura y encriptada</span></div></div></div><div class="flex items-start gap-3" data-v-3b2cc5eb><input${x(Array.isArray(r(h))?g(r(h),null):r(h))?" checked":""} type="checkbox" required class="mt-1 rounded border-gray-300 text-pink-600 focus:ring-pink-500" data-v-3b2cc5eb><label class="text-sm text-gray-600" data-v-3b2cc5eb> Acepto los <a href="#" class="text-pink-600 hover:text-pink-700 underline" data-v-3b2cc5eb>términos y condiciones</a> y la <a href="#" class="text-pink-600 hover:text-pink-700 underline" data-v-3b2cc5eb>política de privacidad</a></label></div></div><div class="sticky bottom-0 bg-white border-t border-gray-200 p-6 rounded-b-xl" data-v-3b2cc5eb><div class="flex items-center justify-between" data-v-3b2cc5eb><div class="text-sm text-gray-500" data-v-3b2cc5eb>`),a(u(o,{name:"heroicons:lock-closed",class:"w-4 h-4 inline mr-1"},null,s)),a(` Pago seguro y protegido </div><div class="flex items-center gap-3" data-v-3b2cc5eb><button class="px-6 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors" data-v-3b2cc5eb> Cancelar </button><button${x(!r(_)||r(p))?" disabled":""} class="px-8 py-2 bg-pink-600 text-white rounded-lg font-semibold hover:bg-pink-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center gap-2" data-v-3b2cc5eb>`),r(p)?a(u(o,{name:"svg-spinners:ring-resize",class:"w-4 h-4"},null,s)):a("\x3c!----\x3e"),a(` ${m(r(p)?"Procesando...":`Pagar ${r(l)(r(c).total)}`)}</button></div></div></div></div></div>`)}}}),j=_.setup;_.setup=(e,t)=>{const a=p();return(a.modules||(a.modules=new Set)).add("components/checkout/MercadoPagoModal.vue"),j?j(e,t):void 0};const C=$(_,[["__scopeId","data-v-3b2cc5eb"]]),P={__name:"cart",__ssrInlineRender:!0,setup(o){const n=w(),{formatCOP:b}=k(),{$toast:p}=e(),$=s([]),j2=e=>{var t;return(null==(t=$.value.filter(t=>t.product_id===e).sort((e,t)=>new Date(t.created_at).getTime()-new Date(e.created_at).getTime())[0])?void 0:t.status)||null},_=s([]),j=s(!1);return(e,s,o,p)=>{const w=t,k=a,$=C;s(`<div${v(d({class:"py-8"},p))}><div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"><h1 class="text-3xl font-bold text-gray-900 mb-8">Carrito de Compras</h1>`),r(n).items.length>0?(s('<div class="bg-gradient-to-r from-pink-50 to-purple-50 rounded-lg p-6 mb-8 border border-pink-200"><div class="flex items-center justify-between"><div class="flex items-center gap-4"><div class="w-12 h-12 bg-pink-100 rounded-full flex items-center justify-center">'),s(u(w,{name:"heroicons:shopping-cart",class:"w-6 h-6 text-pink-600"},null,o)),s(`</div><div><h2 class="text-lg font-semibold text-gray-900">Tu Carrito</h2><p class="text-sm text-gray-600">${m(r(n).count)} producto(s) • Total: ${m(r(b)(r(n).total))}</p></div></div><div class="text-right"><div class="text-2xl font-bold text-pink-600">${m(r(b)(r(n).total))}</div><div class="text-sm text-gray-500">Incluye envío e impuestos</div></div></div></div>`)):s("\x3c!----\x3e"),s(`<div class="grid grid-cols-1 lg:grid-cols-3 gap-8"><div class="lg:col-span-2"><div class="bg-white rounded-lg shadow-sm"><div class="p-6 border-b flex items-center justify-between"><h2 class="text-lg font-semibold text-gray-900">Productos (${m(r(n).count)})</h2><div class="flex items-center gap-2"><button class="px-3 py-2 text-sm border rounded hover:bg-gray-50">Refrescar estados</button><label class="inline-flex items-center gap-2 text-sm text-gray-600"><input type="checkbox"${x(Array.isArray(r(j))?g(r(j),null):r(j))?" checked":""} class="rounded border-gray-300"> Auto </label></div></div>`),0===r(n).items.length?s('<div class="p-6 text-gray-600">Tu carrito está vacío.</div>'):(s("<div>\x3c!--[--\x3e"),f(r(n).items,e=>{var t,a;s('<div class="p-6 border-b"><div class="flex items-center space-x-4"><div class="w-20 h-20 bg-gray-100 rounded-lg flex items-center justify-center overflow-hidden">'),e.image_url?s(`<img${y("src",e.image_url)}${y("alt",e.name)} class="w-full h-full object-cover">`):s(u(w,{name:"heroicons:shopping-bag",class:"w-8 h-8 text-pink-500"},null,o)),s(`</div><div class="flex-1 min-w-0"><h3 class="font-semibold text-gray-900 truncate">${m(e.name)}</h3><p class="text-gray-600 text-sm">SKU: ${m(e.sku)}</p><div class="flex items-center space-x-4 mt-2"><div class="flex items-center border border-gray-300 rounded-lg"><button class="px-3 py-1 hover:bg-gray-100">-</button><span class="px-3 py-1">${m(e.quantity)}</span><button class="px-3 py-1 hover:bg-gray-100">+</button></div><span class="text-lg font-bold text-pink-600">${m(r(b)(e.price*e.quantity))}</span></div></div><div class="flex items-center gap-3">`),j2(e.product_id)?s(`<span class="${h(["inline-flex items-center px-2 py-0.5 text-xs font-medium rounded",(t=j2(e.product_id),{pending:"bg-yellow-100 text-yellow-800",converted:"bg-green-100 text-green-800",cancelled:"bg-red-100 text-red-800"}[t]||"bg-gray-100 text-gray-800")])}">${m((a=j2(e.product_id),{pending:"Pendiente",converted:"Aprobado",cancelled:"Cancelado"}[a]||"Estado"))}</span>`):s("\x3c!----\x3e"),s('<button class="text-red-500 hover:text-red-700">'),s(u(w,{name:"heroicons:trash",class:"w-5 h-5"},null,o)),s("</button></div></div></div>")}),s("\x3c!--]--\x3e</div>")),s(`</div></div><div class="lg:col-span-1"><div class="bg-white rounded-lg shadow-sm p-6"><h2 class="text-lg font-semibold text-gray-900 mb-4">Resumen del Pedido</h2><div class="space-y-3 mb-6"><div class="flex justify-between"><span class="text-gray-600">Subtotal</span><span class="font-semibold">${m(r(b)(r(n).subtotal))}</span></div><div class="flex justify-between"><span class="text-gray-600">Envío</span><span class="font-semibold">${m(r(b)(r(n).shippingAmount))}</span></div><div class="flex justify-between"><span class="text-gray-600">Impuestos</span><span class="font-semibold">${m(r(b)(r(n).taxAmount))}</span></div><div class="border-t pt-3"><div class="flex justify-between"><span class="text-lg font-bold text-gray-900">Total</span><span class="text-lg font-bold text-pink-600">${m(r(b)(r(n).total))}</span></div></div></div><button class="w-full bg-pink-600 text-white py-3 rounded-lg font-semibold hover:bg-pink-700 transition-colors"> Proceder al Pago </button><div class="mt-4 text-center">`),s(u(k,{to:"/shop",class:"text-pink-600 hover:text-pink-700 text-sm"},{default:i((e,t,a,s)=>{if(!t)return[c(" Continuar Comprando ")];t(" Continuar Comprando ")}),_:1},o)),s('</div><div class="mt-8"><div class="flex items-center justify-between mb-4"><h3 class="text-lg font-semibold text-gray-900">Mis Pedidos</h3><button class="text-pink-600 hover:text-pink-700 text-sm font-medium">'),s(u(w,{name:"heroicons:arrow-path",class:"w-4 h-4 inline mr-1"},null,o)),s(" Actualizar </button></div>"),0===r(_).length?(s('<div class="text-center py-8 text-gray-600">'),s(u(w,{name:"heroicons:shopping-bag",class:"w-12 h-12 mx-auto mb-2 text-gray-400"},null,o)),s('<p class="text-sm">Aún no tienes pedidos.</p><p class="text-xs text-gray-500 mt-1">Tus pedidos aparecerán aquí después de completar una compra.</p></div>')):(s('<div class="space-y-4 max-h-96 overflow-auto">\x3c!--[--\x3e'),f(r(_),e=>{var t,a,d,n;s('<div class="border border-gray-200 rounded-lg p-4 bg-gray-50"><div class="flex items-center justify-between mb-3"><div class="flex items-center gap-2">'),s(u(k,{to:`/orders/${e.id_order}`,class:"font-semibold text-pink-600 hover:text-pink-700"},{default:i((t,a,s,d)=>{if(!a)return[c(" Pedido #"+l((e.id_order||"").slice(0,8)),1)];a(` Pedido #${m((e.id_order||"").slice(0,8))}`)}),_:2},o)),s(`<span class="text-xs text-gray-500">${m((d=e.created_at,new Date(d).toLocaleString()))}</span></div><span class="${h([(a=e.status,{pending:"bg-yellow-100 text-yellow-800",confirmed:"bg-blue-100 text-blue-800",shipped:"bg-purple-100 text-purple-800",delivered:"bg-green-100 text-green-800",cancelled:"bg-red-100 text-red-800"}[a]||"bg-gray-100 text-gray-800"),"px-2 py-1 text-xs font-medium rounded-full"])}">${m((n=e.status,{pending:"Pendiente",confirmed:"Confirmado",shipped:"Enviado",delivered:"Entregado",cancelled:"Cancelado"}[n]||n))}</span></div><div class="space-y-2 mb-3">\x3c!--[--\x3e`),f((e.order_items||[]).slice(0,2),e=>{var t,a,d;s('<div class="flex items-center gap-2 text-sm"><div class="w-8 h-8 bg-white rounded flex items-center justify-center overflow-hidden">'),(null==(t=e.product)?void 0:t.image_url)?s(`<img${y("src",e.product.image_url)}${y("alt",null==(a=e.product)?void 0:a.name)} class="w-full h-full object-cover">`):s(u(w,{name:"heroicons:cube",class:"w-4 h-4 text-pink-500"},null,o)),s(`</div><div class="flex-1 min-w-0"><div class="font-medium text-gray-900 truncate">${m(null==(d=e.product)?void 0:d.name)}</div><div class="text-xs text-gray-500">Cant: ${m(e.quantity)}</div></div><div class="text-xs font-medium text-gray-900">${m(r(b)(e.total_price||e.quantity*e.unit_price))}</div></div>`)}),s("\x3c!--]--\x3e"),(e.order_items||[]).length>2?s(`<div class="text-xs text-gray-500 pl-10"> +${m((e.order_items||[]).length-2)} producto(s) más </div>`):s("\x3c!----\x3e"),s(`</div><div class="flex items-center justify-between pt-2 border-t border-gray-200"><div class="text-sm"><span class="text-gray-600">${m((null==(t=e.order_items)?void 0:t.length)||0)} producto(s)</span><span class="text-gray-400 mx-2">•</span><span class="text-gray-600">Total: </span><span class="font-semibold text-pink-600">${m(r(b)(e.total_amount||0))}</span></div><div class="flex items-center gap-2">`),s(u(k,{to:`/orders/${e.id_order}`,class:"text-xs text-pink-600 hover:text-pink-700 font-medium"},{default:i((e,t,a,s)=>{if(!t)return[c(" Ver detalles ")];t(" Ver detalles ")}),_:2},o)),"pending"===e.status?s('<button class="text-xs text-red-600 hover:text-red-700 font-medium"> Cancelar </button>'):s("\x3c!----\x3e"),s("</div></div></div>")}),s("\x3c!--]--\x3e</div>")),r(_).length>0?(s('<div class="mt-4 text-center">'),s(u(k,{to:"/user/orders",class:"text-sm text-pink-600 hover:text-pink-700 font-medium"},{default:i((e,t,a,s)=>{if(!t)return[c(" Ver todos mis pedidos ")];t(" Ver todos mis pedidos ")}),_:1},o)),s("</div>")):s("\x3c!----\x3e"),s("</div></div></div></div></div>"),e.showPaymentModal?s(u($,{onClose:e.closePaymentModal,onSuccess:e.onPaymentSuccess},null,o)):s("\x3c!----\x3e"),s("</div>")}}},q=P.setup;P.setup=(e,t)=>{const a=p();return(a.modules||(a.modules=new Set)).add("pages/shop/cart.vue"),q?q(e,t):void 0};export{P as default};
//# sourceMappingURL=cart-D4qEHP56.mjs.map
