{"version":3,"file":"approve.mjs","sources":["../../../../../../../../../server/api/reservations/[id]/approve.ts"],"sourcesContent":null,"names":["approve","defineEventHandler","async","event","method","getMethod","supabase","serverSupabaseClient","id","getRouterParam","respondError","requireAdmin","config","useRuntimeConfig","adminClient","createClient","public","supabaseUrl","supabaseServiceKey","auth","persistSession","res","from","select","eq","single","reservationError","error","reservation","data","status","quantity","Number","unitPrice","_a","product","price","_b","stock_quantity","customerRes","user_id","customerId","_c","id_customer","profile","user","safeEmail","email","existingByEmail","existingEmailErr","existingEmail","upd","update","is_active","updated_at","Date","toISOString","message","createCust","insert","first_name","last_name","subtotal","newOrder","customer_id","total_amount","tax_amount","shipping_amount","shipping_address","billing_address","payment_method","payment_status","tracking_number","notes","order_source","assigned_user_id","orderRes","orderData","item","order_id","id_order","product_id","unit_price","total_price","itemsRes","delete","stockError","rpc","p_id_product","p_delta","console","respondSuccess","e"],"mappings":"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"}