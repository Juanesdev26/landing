import{d as r,g as o,s as e,h as t,r as i,a,b as s,k as d}from"../../../_/nitro.mjs";import"@supabase/supabase-js";import"node:http";import"node:https";import"node:events";import"node:buffer";import"@supabase/ssr";import"@iconify/utils";import"node:crypto";import"consola";import"ioredis";import"node:fs";import"node:path";const n=r(async r=>{const n=o(r),c=await e(r),f=t(r,"id");if(!f)return i("ID de oferta requerido");if("GET"===n)try{await a(r);const{data:o,error:e}=await c.from("offers").select("\n          *,\n          product:products(id_product, name, sku, price, image_url)\n        ").eq("id_offer",f).single();return e||!o?i("Oferta no encontrada"):s(o)}catch(r){return console.error("GET /api/offers/[id] error:",r),i("Error interno del servidor")}if("PUT"===n)try{await a(r);const o=await d(r),e={};void 0!==o.product_id&&(e.product_id=o.product_id),void 0!==o.discount_percent&&(e.discount_percent=Number(o.discount_percent)),void 0!==o.is_active&&(e.is_active=!!o.is_active),void 0!==o.valid_from&&(e.valid_from=o.valid_from),void 0!==o.valid_to&&(e.valid_to=o.valid_to),void 0!==o.notes&&(e.notes=o.notes);const{data:t,error:n}=await c.from("offers").update(e).eq("id_offer",f).select().single();return n?i("Error actualizando oferta",n.message):s(t,"Oferta actualizada exitosamente")}catch(r){return console.error("PUT /api/offers/[id] error:",r),i("Error interno del servidor")}if("DELETE"===n)try{await a(r);const{error:o}=await c.from("offers").delete().eq("id_offer",f);return o?i("Error eliminando oferta",o.message):s(null,"Oferta eliminada exitosamente")}catch(r){return console.error("DELETE /api/offers/[id] error:",r),i("Error interno del servidor")}return i("MÃ©todo no permitido")});export{n as default};
//# sourceMappingURL=_id_.mjs.map
