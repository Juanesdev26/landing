{"version":3,"file":"_id_.mjs","sources":["../../../../../../../../server/api/orders/[id].ts"],"sourcesContent":null,"names":["_id_","defineEventHandler","async","event","method","getMethod","supabase","serverSupabaseClient","id","getRouterParam","success","error","data","order","from","select","eq","single","code","console","details","message","o","processedOrder","customer_name","customer","first_name","last_name","customer_email","_a","email","customer_phone","_b","phone","items_count","_c","order_items","length","total_amount","subtotal","respondSuccess","respondError","requireAdmin","body","readBody","customer_id","existingOrder","orderError","status","customerError","is_active","currentItems","currentItemsError","item","stockError","update","stock_quantity","raw","quantity","updated_at","Date","toISOString","product_id","orderItems","unit_price","product","productError","name","totalPrice","Number","push","total_price","taxAmount","tax_amount","shippingAmount","shipping_amount","totalAmount","updatedOrder","shipping_address","billing_address","payment_method","payment_status","tracking_number","notes","updateRes","orderData","updateError","deleteItemsError","delete","orderItemsWithOrderId","map","order_id","itemsError","insert","includes","rpc","p_id_product","p_delta","deleteOrderError"],"mappings":"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"}