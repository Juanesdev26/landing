import{d as e,g as r,r as t,a as o,f as s,b as a}from"../../../_/nitro.mjs";import{createClient as d}from"@supabase/supabase-js";import"node:http";import"node:https";import"node:events";import"node:buffer";import"@supabase/ssr";import"@iconify/utils";import"node:crypto";import"consola";import"ioredis";import"node:fs";import"node:path";const i=e(async e=>{if("GET"!==r(e))return t("MÃ©todo no permitido");try{await o(e);const r=s(),t=d(r.public.supabaseUrl,r.supabaseServiceKey,{auth:{persistSession:!1}}),[{count:i},{count:n},{count:c},{count:u},{count:p},{count:m},{count:l}]=await Promise.all([t.from("orders").select("id_order",{count:"exact",head:!0}),t.from("orders").select("id_order",{count:"exact",head:!0}).eq("status","pending"),t.from("orders").select("id_order",{count:"exact",head:!0}).eq("status","delivered"),t.from("orders").select("id_order",{count:"exact",head:!0}).eq("status","cancelled"),t.from("orders").select("id_order",{count:"exact",head:!0}).eq("payment_status","paid"),t.from("reservations").select("id_reservation",{count:"exact",head:!0}).eq("status","pending"),t.from("reservations").select("id_reservation",{count:"exact",head:!0}).eq("status","cancelled")]),f=m||0;return a({total:(i||0)+f,pending:(n||0)+f,delivered:c||0,cancelled:(u||0)+(l||0),paid:p||0})}catch(e){return console.error("GET /api/orders/summary error:",e),t("Error interno del servidor")}});export{i as default};
//# sourceMappingURL=summary.mjs.map
