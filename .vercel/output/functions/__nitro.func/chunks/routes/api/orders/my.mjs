import{d as r,g as o,s as t,r as e,e as s,b as i}from"../../../_/nitro.mjs";import"@supabase/supabase-js";import"node:http";import"node:https";import"node:events";import"node:buffer";import"@supabase/ssr";import"@iconify/utils";import"node:crypto";import"consola";import"ioredis";import"node:fs";import"node:path";const n=r(async r=>{const n=o(r),a=await t(r);if("GET"!==n)return e("MÃ©todo no permitido");try{const o=await s(r);if(!o)return i([]);const{data:t,error:n}=await a.from("customers").select("id_customer").eq("user_id",o.id).single();if(n||!t)return i([]);const{data:d,error:m}=await a.from("orders").select("\n        *,\n        order_items:order_items(\n          id_order_item,\n          quantity,\n          unit_price,\n          total_price,\n          product:products(id_product, name, sku, image_url)\n        )\n      ").eq("customer_id",t.id_customer).order("created_at",{ascending:!1});return m?e("Error obteniendo mis pedidos",m.message):i(d||[])}catch(r){return console.error("GET /api/orders/my error:",r),e("Error interno del servidor")}});export{n as default};
//# sourceMappingURL=my.mjs.map
