import{d as e,g as r,s as t,h as o}from"../../../../_/nitro.mjs";import"@supabase/supabase-js";import"node:http";import"node:https";import"node:events";import"node:buffer";import"@supabase/ssr";import"@iconify/utils";import"node:crypto";import"consola";import"ioredis";import"node:fs";import"node:path";const s=e(async e=>{const s=r(e),a=await t(e),i=o(e,"id");if("PATCH"!==s)return{data:{success:!1,error:"MÃ©todo no permitido"}};if(!i)return{data:{success:!1,error:"ID de cliente requerido"}};try{const{data:e,error:r}=await a.from("customers").select("is_active").eq("id_customer",i).single();if(r)return"PGRST116"===r.code?{data:{success:!1,error:"Cliente no encontrado"}}:(console.error("Error obteniendo estado del cliente:",r),{data:{success:!1,error:"Error obteniendo estado del cliente",details:r.message}});const t=!e.is_active,{data:o,error:s}=await a.from("customers").update({is_active:t,updated_at:(new Date).toISOString()}).eq("id_customer",i).select("id_customer, is_active").single();return s?(console.error("Error actualizando estado del cliente:",s),{data:{success:!1,error:"Error actualizando estado del cliente",details:s.message}}):{data:{success:!0,data:{id_customer:o.id_customer,is_active:o.is_active},message:`Cliente ${o.is_active?"activado":"desactivado"} exitosamente`}}}catch(e){return console.error("Error en PATCH /api/customers/[id]/toggle-status:",e),{data:{success:!1,error:"Error interno del servidor"}}}});export{s as default};
//# sourceMappingURL=toggle-status.mjs.map
