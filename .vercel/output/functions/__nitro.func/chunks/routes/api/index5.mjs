import{d as r,g as o,s as e,a as t,r as i,b as s,k as a}from"../../_/nitro.mjs";import"@supabase/supabase-js";import"node:http";import"node:https";import"node:events";import"node:buffer";import"@supabase/ssr";import"@iconify/utils";import"node:crypto";import"consola";import"ioredis";import"node:fs";import"node:path";const n=r(async r=>{const n=o(r),d=await e(r);if("GET"===n)try{await t(r);const{data:o,error:e}=await d.from("offers").select("\n          *,\n          product:products(id_product, name, sku, price, image_url)\n        ").order("created_at",{ascending:!1});return e?i("Error obteniendo ofertas",e.message):s(o)}catch(r){return console.error("GET /api/offers error:",r),i("Error interno del servidor")}if("POST"===n)try{await t(r);const o=await a(r);if(!o.product_id||void 0===o.discount_percent)return i("product_id y discount_percent son requeridos");const e={product_id:o.product_id,discount_percent:Number(o.discount_percent),is_active:void 0===o.is_active||!!o.is_active,valid_from:o.valid_from||null,valid_to:o.valid_to||null,notes:o.notes||null},{data:n,error:c}=await d.from("offers").insert(e).select().single();return c?i("Error creando oferta",c.message):s(n,"Oferta creada exitosamente")}catch(r){return console.error("POST /api/offers error:",r),i("Error interno del servidor")}return i("MÃ©todo no permitido")});export{n as default};
//# sourceMappingURL=index5.mjs.map
