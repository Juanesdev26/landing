import{d as r,g as o,h as e,s as a,a as t,r as s,b as i}from"../../../../_/nitro.mjs";import"@supabase/supabase-js";import"node:http";import"node:https";import"node:events";import"node:buffer";import"@supabase/ssr";import"@iconify/utils";import"node:crypto";import"consola";import"ioredis";import"node:fs";import"node:path";const c=r(async r=>{const c=o(r),d=e(r,"id"),n=await a(r);if("PATCH"!==c)return{data:{success:!1,error:"Método no permitido"}};if(!d)return{data:{success:!1,error:"ID de categoría requerido"}};try{await t(r);const{data:o,error:e}=await n.from("categories").select("is_active").eq("id_category",d).single();if(e)return"PGRST116"===e.code?{data:{success:!1,error:"Categoría no encontrada"}}:(console.error("Error obteniendo categoría:",e),{data:{success:!1,error:"Error obteniendo categoría"}});const a=!o.is_active,{data:c,error:p}=await n.from("categories").update({is_active:a,updated_at:(new Date).toISOString()}).eq("id_category",d).select().single();return p?(console.error("Error cambiando estado de categoría:",p),s("Error cambiando estado de categoría")):i({...c,product_count:0},`Categoría ${a?"activada":"desactivada"} exitosamente`)}catch(r){return console.error("Error inesperado:",r),s("Error interno del servidor")}});export{c as default};
//# sourceMappingURL=toggle-status.mjs.map
